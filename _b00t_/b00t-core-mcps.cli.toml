[b00t]
name = "b00t-core-mcps"
type = "cli"
hint = "Auto-install core MCP servers required for b00t hive operations"
depends_on = ["uv.cli"]

# Self-healing: Install essential MCP servers for b00t operations
install = '''
# ðŸ¤“ Core MCP servers required for b00t hive functionality
echo "ðŸ¥¾ Installing core MCP servers for b00t operations..."

# Essential MCP servers with dependencies (prioritized by capability)
declare -A MCP_SERVERS=(
    ["b00t-mcp"]="no-deps"           # Core b00t command proxy
    ["github"]="node.cli,gh.cli"     # GitHub integration  
    ["filesystem"]="node.cli"        # File operations
    ["context7"]="node.cli"          # Documentation access
)

# ðŸ¤“ Azure AI Foundry recommended over TaskMaster for complex orchestration
echo "ðŸ’¡ For multi-agent orchestration, consider Azure AI Foundry: b00t cli install azure-ai-foundry"
echo "   TaskMaster suitable for basic task lists only"

# Install each MCP server
for mcp_name in "${!MCP_SERVERS[@]}"; do
    echo "ðŸ“¦ Installing MCP server: $mcp_name"
    
    # Check dependencies
    deps="${MCP_SERVERS[$mcp_name]}"
    if [ "$deps" != "no-deps" ]; then
        IFS=',' read -ra dep_array <<< "$deps"
        for dep in "${dep_array[@]}"; do
            if ! command -v "${dep%.*}" >/dev/null 2>&1; then
                echo "ðŸ”§ Auto-installing dependency: $dep"
                if command -v b00t >/dev/null 2>&1; then
                    b00t cli install "${dep%.*}"
                else
                    echo "âŒ b00t CLI required to install dependency: $dep"
                    exit 1
                fi
            fi
        done
    fi
    
    # Install MCP server to Claude Code (primary target)
    if command -v b00t >/dev/null 2>&1; then
        echo "ðŸ”§ Installing $mcp_name to Claude Code..."
        b00t mcp install "$mcp_name" claudecode
        if [ $? -eq 0 ]; then
            echo "âœ… $mcp_name installed successfully"
        else
            echo "âš ï¸ $mcp_name installation failed, continuing..."
        fi
    else
        echo "âŒ b00t CLI required for MCP installation"
        exit 1
    fi
done

echo "âœ… Core MCP servers installation completed"
'''

update = '''
# Update all core MCP servers  
echo "ðŸ”„ Updating core MCP servers..."
for mcp in b00t-mcp github filesystem taskmaster-ai context7; do
    echo "ðŸ“¦ Updating MCP: $mcp"
    if command -v b00t >/dev/null 2>&1; then
        b00t mcp install "$mcp" claudecode --force
    fi
done
echo "âœ… Core MCP servers updated"
'''

# We can check if MCP servers are installed via Claude Code
version = "echo 'Core MCP bundle v1.0'"
version_regex = 'v(\d+\.\d+)'

[[b00t.usage]]
description = "Install all core MCP servers"
command = "b00t cli install b00t-core-mcps"

[[b00t.usage]]
description = "List installed MCP servers"
command = "b00t mcp list"

[[b00t.usage]]
description = "Install specific MCP server"
command = "b00t mcp install <server> claudecode"

[b00t.learn]
topic = "mcp-core"
auto_digest = true
content = """
# Core MCP Servers for b00t Operations

Essential MCP servers that enable b00t hive functionality:

## Core Set
- **b00t-mcp**: Command proxy with ACL filtering for b00t-cli access
- **github**: GitHub repository management and operations
- **filesystem**: File system operations and project navigation
- **taskmaster-ai**: Task and project management workflows
- **context7**: Documentation and library context retrieval

## Auto-Installation
Use `b00t cli install b00t-core-mcps` to install all core servers with dependency resolution.

## Dependencies
- Node.js (for most MCP servers)
- GitHub CLI (for github MCP server authentication)
- UV (for Python-based MCP servers)
"""