[b00t]
name = "kapp"
type = "cli"
hint = "Deploy k8s resources with smart diffing and waiting. Better than kubectl apply."
desires = "0.63.0"

install = '''
if command -v pkgx >/dev/null 2>&1; then
    # ðŸ¤“ pkgx install syntax removed - use exec pkgx tool@version directly
    mkdir -p ~/.local/bin
    cat > ~/.local/bin/kapp << 'EOF'
#!/bin/bash
exec pkgx kapp@0.63 "$@"
EOF
    chmod +x ~/.local/bin/kapp
elif command -v brew >/dev/null 2>&1; then
    brew tap carvel-dev/carvel
    brew install kapp
else
    # Install via Carvel installer
    wget -O- https://carvel.dev/install.sh | bash
fi
'''

version = "kapp version"
version_regex = 'kapp version (\d+\.\d+\.\d+)'

[[b00t.usage]]
description = "Deploy with diffing preview"
command = "kapp deploy -a myapp -f manifest.yaml"

[[b00t.usage]]
description = "List deployed apps"
command = "kapp list"

[[b00t.usage]]
description = "Delete app"
command = "kapp delete -a myapp"

[[b00t.usage]]
description = "Inspect app resources"
command = "kapp inspect -a myapp --tree"
